# TextSync Figma Plugin

–ü–ª–∞–≥–∏–Ω –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –º–µ–∂–¥—É Figma –∏ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å—é TextSync.

## üöÄ –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π –∫–æ–¥ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ï—Å–ª–∏ –≤ –ø—Ä–æ–µ–∫—Ç–µ —É–∂–µ –µ—Å—Ç—å —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π `code.js`:

1. –°–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª—ã:
   - `manifest.json`
   - `code.js`
   - `ui.html`

2. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤ Figma Desktop:
   - Plugins ‚Üí Development ‚Üí Import plugin from manifest...
   - –í—ã–±–µ—Ä–∏—Ç–µ `manifest.json`

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ö–æ–º–ø–∏–ª—è—Ü–∏—è –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–¥ –ø–ª–∞–≥–∏–Ω–∞:

**–° —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
\`\`\`bash
cd figma-plugin
npm install
npm run build
\`\`\`

**–ë–µ–∑ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ (–±—ã—Å—Ç—Ä–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è):**
\`\`\`bash
cd figma-plugin
npx -y typescript@latest tsc code.ts --target ES2017 --lib ES2017 --skipLibCheck
\`\`\`

**–û–Ω–ª–∞–π–Ω –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://www.typescriptlang.org/play
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `code.ts`
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–∞–∫ `code.js`

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

\`\`\`
figma-plugin/
‚îú‚îÄ‚îÄ manifest.json       # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–ª–∞–≥–∏–Ω–∞
‚îú‚îÄ‚îÄ code.ts            # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ (TypeScript)
‚îú‚îÄ‚îÄ code.js            # –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥
‚îú‚îÄ‚îÄ ui.html            # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–ª–∞–≥–∏–Ω–∞
‚îú‚îÄ‚îÄ package.json       # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îú‚îÄ‚îÄ tsconfig.json      # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ TypeScript
‚îî‚îÄ‚îÄ README.md          # –≠—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
\`\`\`

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫

1. –û—Ç–∫—Ä–æ–π—Ç–µ Figma Desktop (–Ω–µ –±—Ä–∞—É–∑–µ—Ä!)
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–ª–∞–≥–∏–Ω: Plugins ‚Üí Development ‚Üí TextSync
3. –í–≤–µ–¥–∏—Ç–µ URL –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `https://your-app.vercel.app`)
   - URL —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### Export (–≠–∫—Å–ø–æ—Ä—Ç —Ç–µ–∫—Å—Ç–æ–≤ –≤ –∞–¥–º–∏–Ω–∫—É)

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª —Å —Ç–µ–∫—Å—Ç–∞–º–∏ –≤ Figma
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–ª–∞–≥–∏–Ω
3. –ù–∞–∂–º–∏—Ç–µ **"Export to Admin"**

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –°–∫–∞–Ω–∏—Ä—É–µ—Ç –≤—Å–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–ª–æ–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `welcome_message_a3f2`)
- –î–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–µ—Ñ–∏–∫—Å `T:` –∫ –∏–º–µ–Ω–∞–º —Å–ª–æ–µ–≤
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç—ã –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `draft`
- –î—É–±–ª–∏–∫–∞—Ç—ã —Ç–µ–∫—Å—Ç–æ–≤ –ø–æ–ª—É—á–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –∫–ª—é—á

**–ü—Ä–∏–º–µ—Ä:**
\`\`\`
–°–ª–æ–π "–ó–∞–≥–æ–ª–æ–≤–æ–∫" —Å —Ç–µ–∫—Å—Ç–æ–º "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å"
‚Üì
–ü–µ—Ä–µ–∏–º–µ–Ω—É–µ—Ç—Å—è –≤ "T:dobro_pozhalovat_x7k9"
‚Üì
–û—Ç–ø—Ä–∞–≤–∏—Ç—Å—è –≤ –∞–¥–º–∏–Ω–∫—É —Å –∫–ª—é—á–æ–º "dobro_pozhalovat_x7k9"
\`\`\`

### Pull (–ó–∞–≥—Ä—É–∑–∫–∞ –æ–¥–æ–±—Ä–µ–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤)

1. –ö–æ–ø–∏—Ä–∞–π—Ç–µ—Ä –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–ª –∏ –æ–¥–æ–±—Ä–∏–ª —Ç–µ–∫—Å—Ç—ã –≤ –∞–¥–º–∏–Ω–∫–µ
2. –û—Ç–∫—Ä–æ–π—Ç–µ —Ç–æ—Ç –∂–µ —Ñ–∞–π–ª –≤ Figma
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–ª–∞–≥–∏–Ω
4. –ù–∞–∂–º–∏—Ç–µ **"Pull Approved"**

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–æ–ª—å–∫–æ `approved` —Ç–µ–∫—Å—Ç—ã –∏–∑ API
- –ù–∞—Ö–æ–¥–∏—Ç —Å–ª–æ–∏ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `T:` –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –∫–ª—é—á–æ–º
- –û–±–Ω–æ–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç –≤ —ç—Ç–∏—Ö —Å–ª–æ—è—Ö
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É (—Å–∫–æ–ª—å–∫–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ)

## üîÑ –¢–∏–ø–∏—á–Ω—ã–π —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å

\`\`\`
1. –î–∏–∑–∞–π–Ω–µ—Ä —Å–æ–∑–¥–∞–µ—Ç –º–∞–∫–µ—Ç –≤ Figma
   ‚Üì
2. –ó–∞–ø—É—Å–∫–∞–µ—Ç –ø–ª–∞–≥–∏–Ω ‚Üí Export to Admin
   ‚Üì
3. –ö–æ–ø–∏—Ä–∞–π—Ç–µ—Ä –≤–∏–¥–∏—Ç —Ç–µ–∫—Å—Ç—ã –≤ –∞–¥–º–∏–Ω–∫–µ (—Å—Ç–∞—Ç—É—Å: draft)
   ‚Üì
4. –ö–æ–ø–∏—Ä–∞–π—Ç–µ—Ä —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç –∏ –Ω–∞–∂–∏–º–∞–µ—Ç "Approve"
   ‚Üì
5. –î–∏–∑–∞–π–Ω–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø–ª–∞–≥–∏–Ω ‚Üí Pull Approved
   ‚Üì
6. –¢–µ–∫—Å—Ç—ã –≤ Figma –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
\`\`\`

## Features

- **Export to Admin**: Scans all text layers, generates unique keys, and sends them to the admin panel
- **Pull Approved**: Fetches approved texts from the admin and updates text layers in Figma
- **Auto-binding**: Automatically binds duplicate texts to the same key

## ‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π

–§—É–Ω–∫—Ü–∏—è `makeKey()` —Å–æ–∑–¥–∞–µ—Ç –∫–ª—é—á–∏ –∏–∑ —Ç–µ–∫—Å—Ç–∞:
\`\`\`
"–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å" ‚Üí "dobro_pozhalovat_x7k9"
\`\`\`

–§–æ—Ä–º–∞—Ç: `{slugified_text}_{hash}`

### –§–æ—Ä–º–∞—Ç –∏–º–µ–Ω–∏ —Å–ª–æ—è

–ü–ª–∞–≥–∏–Ω –¥–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–µ—Ñ–∏–∫—Å `T:` –∫ –∏–º–µ–Ω–∏ —Å–ª–æ—è:
\`\`\`
"–ó–∞–≥–æ–ª–æ–≤–æ–∫" ‚Üí "T:dobro_pozhalovat_x7k9"
\`\`\`

**–í–ê–ñ–ù–û:** –ù–µ —É–¥–∞–ª—è–π—Ç–µ –ø—Ä–µ—Ñ–∏–∫—Å `T:` –≤—Ä—É—á–Ω—É—é!

### –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è

–û–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Ç–µ–∫—Å—Ç—ã –ø–æ–ª—É—á–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –∫–ª—é—á. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤ –∞–¥–º–∏–Ω–∫–µ –æ–±–Ω–æ–≤–∏—Ç –≤—Å–µ —Å–ª–æ–∏ —Å —ç—Ç–∏–º –∫–ª—é—á–æ–º.

### –®—Ä–∏—Ñ—Ç—ã

–ü–ª–∞–≥–∏–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç —à—Ä–∏—Ñ—Ç—ã –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º —Ç–µ–∫—Å—Ç–∞. –ï—Å–ª–∏ —à—Ä–∏—Ñ—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—Å—è.

## How It Works

### Export
1. Scans all text layers in the document
2. Generates unique keys using `makeKey()` function
3. Stores keys in layer names (format: `T:<key>`)
4. Sends key-value pairs to API endpoint `/api/texts/bulk-upsert`
5. Deduplicates texts with the same content

### Pull
1. Fetches approved texts from API endpoint `/api/texts?status=approved`
2. Finds all text layers with keys (format: `T:<key>`)
3. Loads required fonts
4. Updates text content for matching keys

## API Endpoints Used

- `POST /api/texts/bulk-upsert` - Export texts
- `GET /api/texts?status=approved` - Pull approved texts

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

**–û—à–∏–±–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ "Cannot find name 'figma'":**
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–∏–ø—ã: `npm install`
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É —Å `--skipLibCheck`
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ç–æ–≤—ã–π `code.js`

**–ü–ª–∞–≥–∏–Ω –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ Figma:**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Figma Desktop (–Ω–µ –±—Ä–∞—É–∑–µ—Ä)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–∞ `code.js` (–Ω–µ `code.ts`)

**–û—à–∏–±–∫–∞ "Manifest error: Invalid value for networkAccess":**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `manifest.json` –µ—Å—Ç—å –ø–æ–ª–µ `reasoning` –≤ `networkAccess`
- –≠—Ç–æ —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏

**API –æ—à–∏–±–∫–∏:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL (–±–µ–∑ `/` –≤ –∫–æ–Ω—Ü–µ)
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–æ—Å—Ç—É–ø–Ω–∞
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø—Ä–æ–µ–∫—Ç –∑–∞–¥–µ–ø–ª–æ–µ–Ω –Ω–∞ Vercel

**–¢–µ–∫—Å—Ç—ã –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ Pull:**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–µ–∫—Å—Ç—ã –∏–º–µ—é—Ç —Å—Ç–∞—Ç—É—Å `approved` –≤ –∞–¥–º–∏–Ω–∫–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–ª–æ–∏ –∏–º–µ—é—Ç –ø—Ä–µ—Ñ–∏–∫—Å `T:` –≤ –∏–º–µ–Ω–∏

**–ü–ª–∞–≥–∏–Ω –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç—ã:**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —ç—Ç–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–ª–æ–∏ (–Ω–µ –∫–∞—Ä—Ç–∏–Ω–∫–∏ —Å —Ç–µ–∫—Å—Ç–æ–º)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–ª–æ–∏ –Ω–µ —Å–∫—Ä—ã—Ç—ã

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞–≥–∏–Ω–∞:

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `npm install`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ watch mode: `npm run watch`
3. –ò–∑–º–µ–Ω—è–π—Ç–µ `code.ts`
4. TypeScript –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–µ—Ç `code.js`
5. –í Figma: Plugins ‚Üí Development ‚Üí Reload plugin

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

**–ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–ª–∞–≥–∏–Ω–∞:**
1. Plugins ‚Üí Development ‚Üí Remove plugin
2. –°–Ω–æ–≤–∞ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ `manifest.json`

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ URL API:**
- –ü—Ä–æ—Å—Ç–æ –≤–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π URL –≤ –ø–æ–ª–µ - –æ–Ω —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
